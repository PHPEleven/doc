## redis相关内容

redis备份机制     
   
	RDB：对内存中数据库进行快照   
	AOF: 把每条命令写入文件中   

	RDB通过配置自动生成  满足条件就会执行bgsave命令 

		save   900   1           #900秒内有至少1个键被更改则进行快照；  
		save   300   10          #300秒内有至少10个键被更改则进行快照；  
	 	save   60    10000       #60秒内有至少10000个键被更改则进行快照。  

缓存雪崩？  

	数据未加载到缓存中，或者缓存同一时间大面积的失效，从而导致所有请求都去查数据库，导致数据库CPU和内存负载过高，甚至宕机   

	造成雪崩过程？    

	1.redis大面积故障    
	2.缓存失效，大量请求访问缓存服务redis, redis失效转向mysql数据库      
	3.mysql大量暴增，扛不住直接宕机       
	4.由于大量的服务依赖mysql和redis的服务，网站彻底奔溃       

预防缓存雪崩

	1.缓存的高可用性 
		
	缓存层设计成高可用，防止缓存大面积故障。即使个别节点、个别机器、甚至是机房宕掉，依然可以提供服务，例如 Redis Sentinel 和 Redis Cluster 都实现了高可用。

	Redis-Sentinel是Redis官方推荐的高可用性(HA)解决方案，当用Redis做Master-slave的高可用方案时，假如master宕机了，Redis-sentinel本身也是一个独立运行的进程，它能监控多个master-slave集群，发现master宕机后能进行自懂切换。    

	2.缓存降级  

	可以利用其它 缓存，主要就是对缓存访问进行限流、资源隔离  

	3.redis数据备份和快速预热  

	redis数据备份和恢复

	快速缓存预热
		
	利用异步处理数据加载到缓存中

	4.可以提前演练

什么叫缓存穿透？  
  
	缓存穿透是指查询一个一不存在的数据。   

	例如：从缓存redis没有命中，需要从mysql数据库查询，查不到数据则不写入缓存，这将导致这个不存在的数据每次请求都要到数据库去查询，造成缓存穿透。    

	解决方案？   

	如果查询数据库也为空，直接设置一个默认值存放到缓存，这样第二次到缓冲中获取就有值了，而不会继续访问数据库。    
	设置一个过期时间或者当有值的时候将缓存中的值替换掉即可。    
	可以给key设置一些格式规则，然后查询之前先过滤掉不符合规则的Key。      

什么叫缓存并发？   
  
	这里的并发指的是多个redis的client同时set key引起的并发问题。     
	其实redis自身就是单线程操作，多个client并发操作，按照先到先执行的原则，先到的先执行，其余的阻塞。    
	另外的解决方案是把redis.set操作放在队列中使其串行化，必须的一个一个执行。   